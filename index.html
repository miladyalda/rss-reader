<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RSS Feed Reader</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 20px; }
    #feed { max-width: 800px; margin: auto; background: white; padding: 20px; box-shadow: 0 0 10px #ccc; }
    .feed-item { border-bottom: 1px solid #ddd; margin-bottom: 20px; padding-bottom: 10px; }
    .feed-item h3 { margin: 0; font-size: 1.2em; }
    .feed-item .date { font-size: 0.9em; color: #777; }
  </style>
</head>
<body>
  <div id="feed"><em>Loading...</em></div>
  <script>
    const rawFeedUrl = 'https://www.newsmachine.com/personalfeed/937aed90c2986818bd5c1f98ed0d2c4f.rss';
    const feedUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent(rawFeedUrl);

    fetch(feedUrl)
      .then(response => response.json())
      .then(data => {
        console.log('Fetched RSS data:', data);
        const xml = data.contents;
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xml, 'text/xml');
        const items = xmlDoc.querySelectorAll('item');
        
        const feedDiv = document.getElementById('feed');
        feedDiv.innerHTML = ''; // Clear "Loading..."
        
        items.forEach(item => {
          const title = item.querySelector('title')?.textContent || 'No title';
          const link = item.querySelector('link')?.textContent || '#';
          const description = item.querySelector('description')?.textContent || '';
          const pubDateRaw = item.querySelector('pubDate')?.textContent || '';
          const pubDate = pubDateRaw ? new Date(pubDateRaw).toDateString() : '';

          const feedItem = document.createElement('div');
          feedItem.classList.add('feed-item');
          feedItem.innerHTML = `
            <h3><a href="${link}" target="_blank">${title}</a></h3>
            <p>${description}</p>
            <p class="date">${pubDate}</p>
          `;
          feedDiv.appendChild(feedItem);
        });
      })
      .catch(error => {
        console.error('Error fetching RSS:', error);
        document.getElementById('feed').innerText = 'Failed to load feed.';
      });
  </script>
</body>
</html>
