<script>
const rawFeedUrl = 'https://www.newsmachine.com/personalfeed/937aed90c2986818bd5c1f98ed0d2c4f.rss';
const feedUrl = 'https://api.allorigins.win/get?url=' + encodeURIComponent(rawFeedUrl);

fetch(feedUrl)
  .then(response => response.json())
  .then(data => {
    const xml = data.contents;
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xml, 'text/xml');
    const items = xmlDoc.querySelectorAll('item');

    items.forEach(item => {
      const title = item.querySelector('title')?.textContent || 'No title';
      const link = item.querySelector('link')?.textContent || '#';
      const description = item.querySelector('description')?.textContent || '';
      const pubDateRaw = item.querySelector('pubDate')?.textContent || '';
      const pubDate = pubDateRaw ? new Date(pubDateRaw).toDateString() : '';
      const source = item.querySelector('creator')?.textContent || 'NewsMachine';

      const feedDiv = document.getElementById('feed');
      const feedItem = document.createElement('div');
      feedItem.classList.add('feed-item');
      feedItem.innerHTML = `
        <h3><a href="${link}" target="_blank">${title}</a></h3>
        <p class="source">${source}</p>
        <p>${description}</p>
        <p class="date">${pubDate}</p>
      `;

      feedDiv.appendChild(feedItem);
    });
  })
  .catch(error => console.error('Error fetching or parsing RSS feed:', error));
</script>
